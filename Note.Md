# Notes NodesJS 

## üîπ Typage  

- **Typage dynamique** :  
  - D√©tection du type √† l'ex√©cution, pas √† la compilation.  
  - Impossible de d√©tecter les erreurs de type avant la mise en production.  
  - Le type d'une variable change en fonction de son contenu.  

- **Typage statique** :  
  - Les incoh√©rences de type peuvent √™tre d√©tect√©es √† la compilation.  

---

## ‚öôÔ∏è **Configuration TypeScript**
### **Scripts dans `package.json`**
```json
"scripts": {
  "dev": "nodemon dist/index.js",
  "build": "npx tsc"
}
```

### **Fichier `tsconfig.json`**
- D√©commenter `"types": ["node", "jest"]` (mettre uniquement `["node"]` apr√®s test).
- D√©commenter `"outDir": "./dist"`.

### **Commandes**
1. Compiler le projet :  
   ```sh
   pnpm build
   ```
   - Cr√©era un dossier `dist`.
   - Une erreur peut survenir si `"types"` est mal configur√©.

2. Lancer deux terminaux :  
   - Un pour la **compilation** (`pnpm build`).
   - Un pour l'**ex√©cution** (`pnpm dev`).

3. Charger les variables d'environnement dans `index.ts` :  
   ```ts
   import dotenv from 'dotenv';
   dotenv.config();
   ```

---

### **Logs**
- **Journal de bord** des activit√©s du serveur.
- Utile pour le **debugging** et le suivi des erreurs.

---

#  **API REST**
## **D√©finition**
- Une API REST met √† disposition une **ressource** accessible via des requ√™tes HTTP.

### **Formats de donn√©es**
- **XML** : Langage balis√© pour structurer des donn√©es.
- **JSON** : Format l√©ger et plus utilis√©.

### **Endpoints REST**
- Une **URL** est une **cha√Æne de caract√®res** s√©par√©e par des `/`.
- Chaque **m√©thode HTTP** correspond √† une action.

### **Principes REST**
- **Stateless** : Pas de stockage de contexte entre requ√™tes.
- **Idempotence** : Une requ√™te produit toujours le m√™me effet.

### **Requ√™tes HTTP courantes**
| M√©thode  | Description  |
|----------|-------------|
| **GET**  | Lire une ressource |
| **POST** | Cr√©er une ressource |
| **PUT**  | Modifier/remplacer une ressource |
| **PATCH** | Modifier partiellement une ressource |
| **DELETE** | Supprimer une ressource |

### **Codes HTTP importants**
| Code  | Signification |
|-------|-------------|
| `200` | Succ√®s (OK) |
| `201` | Cr√©ation r√©ussie (POST) |
| `204` | Suppression r√©ussie (DELETE) |
| `400` | Mauvaise requ√™te (client) |
| `500` | Erreur serveur (non anticip√©e) |

---

#  **Comparaison REST, GraphQL et gRPC**
| REST  | GraphQL  | gRPC  |
|-------|---------|------|
| API publiques | Interfaces complexes | Communication interne |
| Architecture simple | Clients vari√©s | Microservices |
| Ressources distinctes | Requ√™tes imbriqu√©es | Haute performance |
| Cache HTTP efficace | √âvite le **overfetching** | Services en temps r√©el |

- **REST** : Standard mature, facile √† mettre en place.
- **GraphQL** : Plus flexible, mais plus complexe.
- **gRPC** : Tr√®s performant, mais moins adapt√© au Web.

### **Tests avec Jest**
## **Pourquoi utiliser Jest ?**
- Permet de **rep√©rer rapidement** les erreurs dans le code.
- V√©rifie **l'avancement du projet** gr√¢ce aux tests.
- Simule des requ√™tes HTTP pour **tester une API**.

### **Tester une API avec Jest**
- Simule les **requ√™tes HTTP**.
- V√©rifie les **r√©ponses attendues** pour chaque endpoint.

---

### **Architecture MVC pour une API REST**
#### **Pourquoi utiliser MVC ?**
- **S√©paration des pr√©occupations**.
- **Maintenance accrue**.
- **Testabilit√© am√©lior√©e**.
- **Scalabilit√© simplifi√©e**.
- **R√©utilisabilit√© du code**.

### **R√¥les principaux**
| Composant  | R√¥le  |
|------------|------|
| **Mod√®le** | Repr√©sente les donn√©es (√©quivalent des tables SQL). |
| **Vue** | G√®re l'affichage (non utilis√© pour une API REST). |
| **Contr√¥leur** | **Orchestre** la logique m√©tier et traite les requ√™tes. |

** Exemple :**  
- Le **contr√¥leur** traite la requ√™te.
- Il appelle la **logique m√©tier**.
- Il utilise le **mod√®le** pour acc√©der aux donn√©es.

---

### **Bases de donn√©es avec MongoDB**
#### **Comparaison SQL vs NoSQL**
| SQL (RDBMS)  | NoSQL (MongoDB)  |
|--------------|----------------|
| **Bases relationnelles** | **Collections de documents** |
| **Tables** | **Collections** |
| **Lignes** | **Documents** |
| **Colonnes** | **Champs** |

#### **Mod√©lisation des donn√©es dans MongoDB**
- **Mod√®le** : D√©finit la structure des donn√©es.
- **Validation** : V√©rifie les types et contraintes.
- **Conversion** : G√®re les formats entre l‚Äôapplication et la base.

## **Mongoose**
- G√®re la connexion et les requ√™tes MongoDB en JavaScript.
- **Avantage** : La structure des donn√©es en **JavaScript** est **identique** √† celle de la base.
